<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rtd Cambios - Trocas Registradas</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="./styles/painel.css">
    <link rel="stylesheet" href="./styles/trocasRegistradas.css">
    <link rel="shortcut icon" href="./images/logo.png" type="image/png">
</head>
<body>

    <div id="data-header"></div>
    <main class="container mt-4">
        <div class="painel-header">
            <h1><i class="fas fa-list-check me-3"></i>Trocas Registradas</h1>
            <p class="lead">Visualize, edite ou exclua os registros de troca de óleo</p>
        </div>

        <div class="row justify-content-center">
            <div class="col-lg-10">
                
                <!-- Filtros -->
                <div class="filtros-container mb-4">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="selectClienteFiltro" class="form-label fw-bold text-light">
                                <i class="fas fa-user me-2"></i>Filtrar por Cliente:
                            </label>
                            <select id="selectClienteFiltro" class="form-select form-select-custom">
                                <option value="">Selecionar Cliente</option>
                                <!-- Clientes serão carregados via JS -->
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="selectVeiculoFiltro" class="form-label fw-bold text-light">
                                <i class="fas fa-car me-2"></i>Filtrar por Veículo:
                            </label>
                            <select id="selectVeiculoFiltro" class="form-select form-select-custom" disabled>
                                <option value="">Selecionar Veículo do Cliente</option>
                                <!-- Veículos serão carregados via JS -->
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Lista de Trocas -->
                <div class="trocas-container">
                    <div class="trocas-header">
                        <h3><i class="fas fa-history me-2"></i>Histórico de Trocas</h3>
                        <div class="total-registros">
                            <span class="badge bg-primary"><span id="totalRegistros">0</span> registro(s)</span>
                        </div>
                    </div>

                    <!-- Lista vazia -->
                    <div id="listaVazia" class="lista-vazia" style="display: none;">
                        <i class="fas fa-inbox fa-3x mb-3"></i>
                        <h4>Nenhum registro encontrado</h4>
                        <p>Não há trocas de óleo registradas para os filtros selecionados.</p>
                    </div>

                    <!-- Cards das Trocas -->
                    <div id="listaTrocas" class="trocas-list">
                        <!-- Cards serão gerados dinamicamente via JavaScript -->
                    </div>
                </div>

            </div>
        </div>
    </main>

    <!-- Modal de Confirmação de Exclusão -->
    <div class="modal fade" id="modalExcluir" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content modal-custom">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                        Confirmar Exclusão
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Tem certeza que deseja excluir este registro de troca de óleo?</p>
                    <div class="alert alert-warning">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Atenção:</strong> Esta ação não pode ser desfeita.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmarExclusao">
                        <i class="fas fa-trash me-2"></i>Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Edição -->
    <div class="modal fade" id="modalEditar" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content modal-custom">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-edit text-warning me-2"></i>
                        Editar Registro de Troca
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formEditar">
                        <div class="cliente-info-modal mb-3">
                            <h6><i class="fas fa-user me-2"></i>Cliente: <span id="editClienteNome"></span></h6>
                            <p><i class="fas fa-car me-2"></i>Veículo: <span id="editVeiculoInfo"></span></p>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <label for="editDataTroca" class="form-label fw-bold">
                                    <i class="fas fa-calendar-check me-2"></i>Data da Troca Realizada:
                                </label>
                                <input type="date" id="editDataTroca" class="form-control mb-3" required>
                            </div>
                            <div class="col-md-6">
                                <label for="editProximaTroca" class="form-label fw-bold">
                                    <i class="fas fa-calendar-plus me-2"></i>Data da Próxima Troca:
                                </label>
                                <input type="date" id="editProximaTroca" class="form-control mb-3" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <label for="editKmAtual" class="form-label fw-bold">
                                    <i class="fas fa-tachometer-alt me-2"></i>Km Atual (Troca Realizada):
                                </label>
                                <input type="number" id="editKmAtual" class="form-control mb-3" placeholder="Ex: 50000" required>
                            </div>
                            <div class="col-md-6">
                                <label for="editKmProxima" class="form-label fw-bold">
                                    <i class="fas fa-road me-2"></i>Km da Próxima Troca:
                                </label>
                                <input type="number" id="editKmProxima" class="form-control mb-3" placeholder="Ex: 55000" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-12">
                                <label for="editTipoOleo" class="form-label fw-bold">
                                    <i class="fas fa-oil-can me-2"></i>Tipo de Óleo Utilizado:
                                </label>
                                <input type="text" id="editTipoOleo" class="form-control mb-3" placeholder="Ex: Castrol GTX 20W-50" required>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" id="salvarEdicao">
                        <i class="fas fa-save me-2"></i>Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script type="module">
    import { renderHeader } from './src/components/header.js';
    renderHeader({ 
        customLinks: [
        { url: 'trocaOleo.html', text: 'Registrar Troca', iClass:'fas fa-oil-can' }
        ]
    });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="js/trocarRegistro.js"></script>
</body>
</html>
